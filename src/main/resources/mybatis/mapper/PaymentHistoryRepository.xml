<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.nginx.auth.repository.PaymentHistoryRepository">

    <resultMap id="BaseResultMap" type="org.nginx.auth.model.PaymentHistory">
        <id column="id" property="id" />
        <result column="order_id" property="orderId" />
        <result column="user_id" property="userId" />
        <result column="premium_plan_id" property="premiumPlanId" />
        <result column="order_pay_channel" property="orderPayChannel" />
        <result column="trade_no" property="tradeNo" />
        <result column="order_pay_time" property="orderPayTime" />
        <result column="order_pay_amount" property="orderPayAmount" />
        <result column="premium_plan_name" property="premiumPlanName" />
        <result column="premium_plan_desc" property="premiumPlanDesc" />
        <result column="pattern" property="pattern" />
        <result column="premium_plan_price" property="premiumPlanPrice" />
        <result column="premium_plan_time_unit" property="premiumPlanTimeUnit" />
        <result column="premium_plan_time_value" property="premiumPlanTimeValue" />
        <result column="create_time" property="createTime" />
        <result column="update_time" property="updateTime" />
    </resultMap>

    <sql id="Base_Column_List">
        `id`, `order_id`, `user_id`, `premium_plan_id`, `order_pay_channel`, `trade_no`,
        `order_pay_time`, `order_pay_amount`, `premium_plan_name`, `premium_plan_desc`, `pattern`,
        `premium_plan_price`, `premium_plan_time_unit`, `premium_plan_time_value`,
        `create_time`, `update_time`
    </sql>

    <select id="selectListByAccountId" resultMap="BaseResultMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM payment_history
        WHERE account_id = #{accountId}
<!--        ORDER BY id DESC-->
    </select>

    <update id="updateOrderPayInfo" parameterType="org.nginx.auth.model.PaymentHistory">
        UPDATE payment_history
        SET trade_no = #{tradeNo},
        order_pay_time = #{orderPayTime},
        order_pay_amount = #{orderPayAmount}
        WHERE order_id = #{orderId}
    </update>

</mapper>
